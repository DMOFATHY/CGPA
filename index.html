<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>حساب المعدل التراكمي - GPA</title>
  <style>
    body { font-family: 'Arial'; padding: 20px; background: #f9f9f9; color: #333; text-align: center; }
    input, button { padding: 10px; margin: 5px; border-radius: 5px; border: 1px solid #ccc; }
    .material { margin-bottom: 10px; }
    #result, #finalGPA { font-size: 1.2em; margin-top: 20px; }
    footer { margin-top: 40px; font-size: 0.9em; color: #777; }
  </style>
</head>
<body>

  <h2>حساب المعدل الفصلي</h2>
  <div id="materials"></div>
  <button onclick="addMaterial()">➕ إضافة مادة</button>
  <button onclick="calculateGPA()">📊 احسب المعدل</button>
  <div id="result"></div>

  <hr>

  <h2>حساب المعدل التراكمي</h2>
  <input id="gpa1" type="number" placeholder="GPA الترم الأول" step="0.01" min="0" max="4">
  <input id="hours1" type="number" placeholder="عدد الساعات الترم الأول" min="1">
  <br>
  <input id="gpa2" type="number" placeholder="GPA الترم الثاني" step="0.01" min="0" max="4">
  <input id="hours2" type="number" placeholder="عدد الساعات الترم الثاني" min="1">
  <br>
  <button onclick="calculateFinalGPA()">📚 احسب التراكمي</button>
  <div id="finalGPA"></div>

  <footer>
    ⚡ تم الإنشاء بواسطة د. Mohamed Fathy - 01091964996  
    <br><br>
    👁️ <span id="visits">تحميل عدد الزيارات...</span>
    <script>
      fetch('https://api.countapi.xyz/hit/gpa-dmo/visits')
        .then(res => res.json())
        .then(data => {
          document.getElementById("visits").innerText = "عدد الزوار: " + data.value;
        });
    </script>
  </footer>

  <script>
    function addMaterial() {
      const container = document.getElementById("materials");
      const div = document.createElement("div");
      div.className = "material";
      div.innerHTML = `
        <input type="number" placeholder="عدد الساعات" min="1">
        <input type="number" placeholder="الدرجة" min="0" max="100">
      `;
      container.appendChild(div);
    }

    function calculateGPA() {
      const materials = document.querySelectorAll(".material");
      let totalHours = 0, totalPoints = 0;
      materials.forEach(m => {
        const hours = parseFloat(m.children[0].value);
        const grade = parseFloat(m.children[1].value);
        if (!isNaN(hours) && !isNaN(grade)) {
          let point = 0;
          if (grade >= 90) point = 4;
          else if (grade >= 85) point = 3.7;
          else if (grade >= 80) point = 3.3;
          else if (grade >= 75) point = 3;
          else if (grade >= 70) point = 2.7;
          else if (grade >= 65) point = 2.4;
          else if (grade >= 60) point = 2;
          totalHours += hours;
          totalPoints += point * hours;
        }
      });
      const result = (totalPoints / totalHours).toFixed(2);
      document.getElementById("result").innerText = isNaN(result) ? "" : "📘 المعدل الفصلي: " + result;
    }

    function calculateFinalGPA() {
      const gpa1 = parseFloat(document.getElementById("gpa1").value);
      const hours1 = parseFloat(document.getElementById("hours1").value);
      const gpa2 = parseFloat(document.getElementById("gpa2").value);
      const hours2 = parseFloat(document.getElementById("hours2").value);
      if (!isNaN(gpa1) && !isNaN(hours1) && !isNaN(gpa2) && !isNaN(hours2)) {
        const totalGPA = ((gpa1 * hours1) + (gpa2 * hours2)) / (hours1 + hours2);
        document.getElementById("finalGPA").innerText = "📘 المعدل التراكمي: " + totalGPA.toFixed(2);
      } else {
        document.getElementById("finalGPA").innerText = "";
      }
    }
  </script>
</body>
</html>
